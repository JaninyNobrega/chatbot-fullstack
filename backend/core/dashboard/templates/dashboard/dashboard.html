{% extends "admin/base_site.html" %}
{% load static %}

{% block extrahead %}
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
{% endblock %}

{% block content %}
<div class="p-6">
    <h1 class="text-2xl font-bold text-blue-700 mb-6">Dashboard Administrativo</h1>

    <div class="bg-white p-6 rounded-xl shadow mb-6">
        <h2 class="text-lg font-semibold text-blue-700">Total de Mensagens</h2>
        <p class="text-4xl font-bold text-blue-500 mt-2">{{ total_messages }}</p>
    </div>

    <div class="bg-white p-6 rounded-xl shadow">
        <h2 class="text-lg font-semibold text-blue-700 mb-4">Mensagens por Usu√°rio</h2>
        <canvas id="messagesChart"></canvas>
    </div>
</div>

<script>
    const labels = [
        {% for item in messages_by_user %}
            "{{ item.user }}",
        {% endfor %}
    ];

    const data = [
        {% for item in messages_by_user %}
            {{ item.total }},
        {% endfor %}
    ];

    new Chart(document.getElementById('messagesChart'), {
        type: 'bar',
        data: {
            labels: labels,
            datasets: [{
                label: "Total de Mensagens",
                data: data,
                borderWidth: 1
            }]
        },
        options: {
            responsive: true
        }
    });
</script>
{% endblock %}
